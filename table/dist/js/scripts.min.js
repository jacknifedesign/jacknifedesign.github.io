var JACKNIFE=JACKNIFE||{};!function($){$(document).ready(function(){$(".table-sort").each(function(){new JACKNIFE.TableSort($(this)).init()}),$(".table-filter").each(function(){new JACKNIFE.TableFilter($(this)).init()})})}(jQuery),function($){JACKNIFE.TableFilter=function(el){var $el=$(el),$body=$("tbody",$el),$triggers=$('select[data-filter-table="'+$el.attr("id")+'"]');$("tr",$body).toArray();this.init=function(){console.log("init"),$triggers&&$triggers.on("change",_filter)};var _filter=function(e){e.preventDefault();var $trigger=$(this),value=($trigger.data("filter-column"),$trigger.val());$trigger.val()?console.log(value):console.log("no value"),new Array,console.log("filter")}}}(jQuery),function($){JACKNIFE.TableSort=function(el){var $el=$(el),$body=$("tbody",$el),$triggers=$(".sort-trigger",$el),direction="DESC",type="default",date_format=$el.data("date-format")?$el.data("date-format").toUpperCase():"DMY",rows=$("tr",$body).toArray();this.init=function(){$triggers.on("click",_click);var $target=$(".sort-trigger.active",$el);$(".sort-trigger.active",$el)&&(_set_direction($target),_set_type($target),_sort($target))};var _click=function(e){e.preventDefault();var $target=$(this);_set_direction($target),_set_type($target),_sort($target)},_set_direction=function($target){$target.hasClass("active")?$target.hasClass("sort-asc")?($target.removeClass("sort-asc"),$target.addClass("sort-desc"),direction="DESC"):$target.hasClass("sort-desc")&&($target.removeClass("sort-desc"),$target.addClass("sort-asc"),direction="ASC"):($triggers.removeClass("active sort-desc sort-asc"),$target.addClass("active sort-desc"),direction="DESC")},_set_type=function($target){type=$target.data("sort")?$target.data("sort"):"default"},_sort=function($target){var index=$target.index();rows=rows.sort(_compare(index)),"DESC"===direction&&(rows=rows.reverse());for(var i=0;i<rows.length;i++)$body.append(rows[i])},_compare=function(index){return function(a,b){var valA=_get_value(a,index),valB=_get_value(b,index);return"date"===type?(valA=_format_date(valA))-(valB=_format_date(valB)):$.isNumeric(valA)&&$.isNumeric(valB)?valA-valB:(valA=valA.toString(),valB=valB.toString(),valA.localeCompare(valB))}},_get_value=function(row,index){return $("td",row).eq(index).text()},_format_date=function(str){var date,day,month,year;if(!((str=(str=(str=str.toLowerCase()).replace(/^[^a-z0-9]*/,"")).replace(/[^a-z0-9]*$/,"")).length<1||(date=(str=str.replace(/[^a-z0-9]+/g,",")).split(",")).length<3)){for(var i=0;i<3;i++){var target=date_format.substr(i,1);"D"===target?day=date[i]:"M"===target?month=date[i]:"Y"===target&&(year=date[i])}(day=day.replace(/^0/,""))<10&&(day="0"+day);if(/[a-z]/.test(month))switch(month=month.substr(0,3)){case"jan":month=String(1);break;case"feb":month=String(2);break;case"mar":month=String(3);break;case"apr":month=String(4);break;case"may":month=String(5);break;case"jun":month=String(6);break;case"jul":month=String(7);break;case"aug":month=String(8);break;case"sep":month=String(9);break;case"oct":month=String(10);break;case"nov":month=String(11);break;case"dec":month=String(12);break;default:month=String(0)}return(month=month.replace(/^0/,""))<10&&(month="0"+month),(year=parseInt(year))<100&&(year=parseInt(year)+2e3),""+String(year)+String(month)+String(day)}}}}(jQuery);